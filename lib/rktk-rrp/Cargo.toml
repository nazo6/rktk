[package]
name = "rktk-rrp"
authors.workspace = true
license.workspace = true
version.workspace = true
edition.workspace = true
repository.workspace = true

[dependencies]
futures = { workspace = true }
rktk-keymanager = { workspace = true, features = ["postcard"] }
postcard = { workspace = true, features = ["experimental-derive"] }

serde = { workspace = true, features = ["derive"] }
serde_with = { workspace = true }
macro_rules_attribute = { workspace = true }
log = { workspace = true }
thiserror = { workspace = true }

# server deps
heapless = { workspace = true, optional = true }
embedded-io-async = { workspace = true, optional = true }

# client deps
specta = { workspace = true, optional = true, features = ["derive"] }
tsify-next = { workspace = true, optional = true }
wasm-bindgen = { workspace = true, optional = true }

[dev-dependencies]
tokio = { version = "1.41.1", features = ["full"] }
async-compat = "0.2.4"
backtrace-on-stack-overflow = "0.3.0"

[features]
default = []

server = ["dep:heapless", "dep:embedded-io-async"]
client = ["std"]

std = ["postcard/use-std", "futures/std"]

specta = ["dep:specta", "rktk-keymanager/specta"]
tsify = ["dep:tsify-next", "dep:wasm-bindgen", "rktk-keymanager/tsify"]

_check = ["server", "client"]
